{% extends 'base.html.twig' %}

{% block title %}Articles de la catégorie {{ category.label }}{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <style>
        .app-sticky-top {
            top: 64px;
        }
    </style>
{% endblock %}

{% block body %}
    <div class="col-3 d-none d-md-block">
        <div class="card mb-2 border-0 sticky-top app-sticky-top">
            <div class="card-body">
                <h5 class="card-title">Catégories</h5>
                <ul class="list-group list-group-flush small">
                    {% for cat in categories %}
                        <li class="list-group-item d-flex justify-content-between align-items-center small">
                            <a href="{{ path('app_category_articles', { id: cat.id }) }}" class="text-decoration-none stretched-link">
                                {% if cat.id == category.id %}<strong>{% endif %}
                                {{ cat.label }}
                                {% if cat.id == category.id %}</strong>{% endif %}
                            </a>
                            <span class="badge {% if cat.id == category.id %}bg-primary{% else %}bg-secondary{% endif %} rounded-pill small">{{ cat.nb }}</span>
                        </li>
                    {% else %}
                        <li class="list-group-item small">Aucune catégorie</li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
    <div class="col">
        {% for cat in categories|filter((v) => v.id == category.id) %}
        <h6>
            {{ category.label }}
            <span class="badge bg-primary rounded-pill small ms-2">{{ cat.nb }}</span>
            <div class="dropdown d-inline-block d-md-none ms-2">
                <a class="btn btn-sm btn-secondary dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                    <i class="fa-solid fa-bars"></i>
                </a>

                <ul class="dropdown-menu">
                    {% for v in categories %}
                    <li>
                        <a class="dropdown-item" href="{{ path('app_category_articles', { id: v.id }) }}">
                            {% if v.id == category.id %}<strong>{% endif %}
                            {{ v.label }}
                            {% if v.id == category.id %}</strong>{% endif %}
                            <span class="badge {% if v.id == category.id %}bg-primary{% else %}bg-secondary{% endif %} rounded-pill small">{{ v.nb }}</span>
                        </a>
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </h6>
        <table class="table table-striped">
            <thead>
            <tr>
                <th>ID</th>
                <th width="200">Image</th>
                <th>Nom</th>
                <th class="text-center">Dispo</th>
                <th class="text-center">Actions</th>
            </tr>
            </thead>
            <tbody>
            {% for article in articles %}
                <tr>
                    <td class="align-middle text-center small" style="font-size: xx-small">DUO<br>#{{ article.id }}</td>
                    <td>
                        <img src="{{ asset('uploads/' ~ article.image) }}" class="rounded img-thumbnail" />
                    </td>
                    <td class="align-middle">{{ article.label }}</td>
                    <td class="text-center align-middle">{{ article.disponible ? '<i class="fa-solid fa-circle-check"></i>' : '<i class="fa-regular fa-circle"></i>' }}</td>
                    <td class="text-center align-middle">
                        {% if is_granted('ROLE_ADMIN') %}
                            <a href="{{ path('app_article_edit', {'id': article.id}) }}">
                                <i class="fa-solid fa-pen"></i>
                            </a>
                        {% else %}
                            <a href="{{ path('app_article_show', {'id': article.id}) }}">
                                <i class="fa-solid fa-eye"></i>
                            </a>
                        {% endif %}
                    </td>
                </tr>
            {% else %}
                <tr>
                    <td colspan="16">no records found</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        {% endfor %}
    </div>
{% endblock %}
